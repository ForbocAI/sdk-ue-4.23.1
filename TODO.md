# TODO — Port ForbocAI SDK from UE 5.7.3 to UE 4.23.1

`Pórt_Séquence // UE5_to_UE4`

> *T̶h̵e̶ ̶o̵l̶d̵ ̷e̶n̶g̶i̷n̵e̶ ̵a̸w̶a̵k̶e̵n̸s̵.*

---

## Legend

- [ ] Not started
- [~] In progress
- [x] Complete

---

## Phase 0 — Project Scaffolding

> `ᚠ // Foundátion`

- [ ] **0.1** Create `.gitignore` (port from 5.7.3, verify UE4.23 paths)
- [ ] **0.2** Create `ForbocAI_SDK.uproject`
  - Change `EngineAssociation` from `"5.7"` to `"4.23"`
  - Keep `ForbocAI_SDK` plugin reference
- [ ] **0.3** Create `Source/ForbocAI_SDK.Target.cs`
  - Change `BuildSettingsVersion.V6` → `BuildSettingsVersion.V2`
  - Remove `IncludeOrderVersion` line (does not exist in UE 4.23)
- [ ] **0.4** Create `Source/ForbocAI_SDK_Editor.Target.cs`
  - Same changes as 0.3 but `TargetType.Editor`
- [ ] **0.5** Create plugin directory structure:
  ```
  Plugins/ForbocAI_SDK/
  ├── ForbocAI_SDK.uplugin
  ├── Config/
  │   └── DefaultForbocAI_SDK.ini
  ├── Resources/
  │   └── Icon128.png
  └── Source/ForbocAI_SDK/
      ├── ForbocAI_SDK.Build.cs
      ├── Public/
      │   └── Core/
      └── Private/
  ```

---

## Phase 1 — Plugin Descriptor & Build Configuration

> `ᚢ // Build_Sýstem`

- [ ] **1.1** Create `Plugins/ForbocAI_SDK/ForbocAI_SDK.uplugin`
  - Change `EngineVersion` from `"5.7.3"` to `"4.23.1"`
  - Change description to reference UE 4.23.1
  - Keep Module `"Type": "Runtime"`, `"LoadingPhase": "Default"`
- [ ] **1.2** Create `Plugins/ForbocAI_SDK/Source/ForbocAI_SDK/ForbocAI_SDK.Build.cs`
  - Port from 5.7.3 version
  - Verify `ReadOnlyTargetRules` is available (introduced UE 4.15 — OK)
  - Verify `PCHUsageMode.UseExplicitOrSharedPCHs` is available (UE 4.21+ — OK)
  - Dependencies: `Core`, `CoreUObject`, `Engine`, `InputCore`, `HTTP`, `Json`, `JsonUtilities`
  - Confirm all dependency modules exist in UE 4.23.1
- [ ] **1.3** Create `Plugins/ForbocAI_SDK/Config/DefaultForbocAI_SDK.ini`
  - Port directly from 5.7.3 (logging config, HTTP settings)
- [ ] **1.4** Create placeholder `Plugins/ForbocAI_SDK/Resources/Icon128.png`

---

## Phase 2 — Functional Core Library (Pure C++11)

> `ᚦ // Functional_Córe`

This is pure C++11 with no UE dependencies — should port **as-is**.

- [ ] **2.1** Copy `functional_core.hpp` to `Public/Core/functional_core.hpp`
  - Verify: no C++14/17 features used (already strict C++11)
  - Verify: `seq`, `gen_seq`, `apply` backports are present
  - Contents: `Maybe<T>`, `Either<E,T>`, `Curried<>`, `Lazy<T>`, `Pipeline<T>`, `Composed<>`, `fmap`
- [ ] **2.2** Copy `C++11-FP-GUIDE.md` to project root
  - Update file path references if plugin directory name differs
- [ ] **2.3** Compile test `functional_core.hpp` in isolation against UE 4.23 headers
  - Validate template deduction works with MSVC 2017 / Clang (UE 4.23 toolchains)

---

## Phase 3 — Type Definitions

> `ᚱ // Dáta_Types`

- [ ] **3.1** Port `Public/ForbocAI_SDK_Types.h`
  - USTRUCTs: `FAgentState`, `FMemoryItem`, `FAgentAction`, `FValidationResult`, `FSoul`
  - Plain structs: `FAgentResponse`, `FAgentConfig`
  - **UE4 change**: Verify `GENERATED_BODY()` works for `USTRUCT()` in UE 4.23 (should be fine, introduced UE 4.11)
  - **UE4 change**: Verify `TMap<FString, float>` UPROPERTY reflection works in 4.23
  - **UE4 change**: Replace `FORBOCAI_SDK_API` macro — confirm it matches the module name exactly (auto-generated by UBT from module name `FORBOCAI_SDK_API`)
- [ ] **3.2** Verify generated header include: `ForbocAI_SDK_Types.generated.h` path resolves correctly

---

## Phase 4 — Module Entry Point

> `ᛒ // Module_Lóad`

- [ ] **4.1** Port `Private/ForbocAI_SDK.cpp`
  - `IMPLEMENT_MODULE(FDefaultModuleImpl, ForbocAI_SDK);`
  - This is identical across UE4/UE5 — direct copy
- [ ] **4.2** Verify module loads in UE 4.23 Editor (`Edit > Plugins`)

---

## Phase 5 — Agent Module

> `ᛟ // Agent_Córe`

- [ ] **5.1** Port `Public/AgentModule.h`
  - `FAgent` struct (immutable data: Id, Persona, State, Memories, ApiUrl)
  - `AgentFactory` namespace (Create, FromSoul)
  - `AgentOps` namespace (CalculateNewState, Process, Export)
  - **UE4 change**: Verify `const` member initialization in aggregate struct with UE 4.23 compiler
  - Functional pattern: factory functions, namespace-based ops, copy-on-write
- [ ] **5.2** Port `Private/AgentModule.cpp`
  - `FGuid::NewGuid().ToString()` — available in UE 4.23 ✓
  - `FString::Printf` — available ✓
  - `TArray<FMemoryItem>()` — available ✓
  - `AgentOps::CalculateNewState` — pure function, direct port
  - `AgentOps::Process` — stub implementation, direct port
  - `AgentOps::Export` — pure function, direct port

---

## Phase 6 — Bridge Module

> `ᚲ // Bridge_Válid`

- [ ] **6.1** Port `Public/BridgeModule.h`
  - `FBridgeValidationContext` struct
  - `FValidationRule` struct (wraps `std::function`)
  - `BridgeOps` namespace (CreateDefaultRules, Validate)
  - **UE4 check**: `std::function` with UE types as parameters — should work in 4.23
  - **UE4 check**: Initializer-list constructor `TArray<FString> InTypes` — verify brace-init `{TEXT("MOVE"), TEXT("move")}` compiles
- [ ] **6.2** Port `Private/BridgeModule.cpp`
  - `BridgeRules::ValidateMovement` — pure function, direct port
  - `BridgeRules::ValidateAttack` — pure function, direct port
  - `BridgeOps::CreateDefaultRules` — uses brace-init for `TArray`; verify UE 4.23 supports `TArray` initializer lists
  - `BridgeOps::Validate` — pure function, direct port
  - **Potential UE4 issue**: `TArray` brace initialization `{TEXT("MOVE"), TEXT("move")}` may not compile in UE 4.23. If not, use explicit `TArray` construction with `.Add()` calls

---

## Phase 7 — Memory Module

> `ᛗ // Memory_Stóre`

- [ ] **7.1** Port `Public/MemoryModule.h`
  - `FMemoryStore` struct (immutable, functional Add)
  - `MemoryOps` namespace (GenerateEmbedding, Store, Recall)
  - Direct port — no UE5-specific APIs
- [ ] **7.2** Port `Private/MemoryModule.cpp`
  - `FGuid::NewGuid()` — available ✓
  - `FDateTime::Now().ToUnixTimestamp()` — available in UE 4.23 ✓
  - `TArray::Sort()` with lambda — available ✓
  - `TArray::SetNum()` — available ✓
  - Direct port expected

---

## Phase 8 — Soul Module

> `ᛊ // Soul_Sérial`

- [ ] **8.1** Port `Public/SoulModule.h`
  - `SoulOps` namespace (FromAgent, Serialize, Deserialize, Validate)
  - Direct port — no UE5-specific APIs
- [ ] **8.2** Port `Private/SoulModule.cpp`
  - **UE4 change**: `#include "JsonObjectConverter.h"` — In UE 4.23, the include path may be `"JsonUtilities/Public/JsonObjectConverter.h"` or simply `"JsonObjectConverter.h"` (verify against engine headers)
  - `FJsonObjectConverter::UStructToJsonObjectString()` — available in UE 4.23 ✓
  - `FJsonObjectConverter::JsonObjectStringToUStruct()` — available in UE 4.23 ✓
  - Verify 4-arg overload `(Json, &Soul, 0, 0)` exists in 4.23 (check vs. 3-arg version)

---

## Phase 9 — CLI Module

> `ᛏ // CLI_Óperate`

- [ ] **9.1** Port `Public/CLIModule.h`
  - `CLIOps` namespace function declarations
  - Direct port
- [ ] **9.2** Port `Private/CLIModule.cpp`
  - **UE4 BREAKING CHANGE**: `FHttpModule::Get().CreateRequest()` returns `TSharedRef<IHttpRequest>` in UE 4.23 — **NOT** `TSharedRef<IHttpRequest, ESPMode::ThreadSafe>` (the `ESPMode::ThreadSafe` template parameter was added in UE 5.x)
  - Change: `TSharedRef<IHttpRequest, ESPMode::ThreadSafe> Request = ...` → `TSharedRef<IHttpRequest> Request = ...`
  - **UE4 change**: Verify `TFunction` callback works the same way in 4.23
  - **UE4 change**: `Request->OnProcessRequestComplete().BindLambda(OnComplete)` — verify `BindLambda` with `TFunction` in UE 4.23
  - Include paths to verify:
    - `"HttpModule.h"` — may need `"Http.h"` or `"Runtime/Online/HTTP/Public/HttpModule.h"` in 4.23
    - `"Interfaces/IHttpRequest.h"` — verify path
    - `"Interfaces/IHttpResponse.h"` — verify path
  - `FHttpRequestPtr` / `FHttpResponsePtr` typedefs — verify availability
  - Lambda captures with UE4 delegates — verify compatibility

---

## Phase 10 — Commandlet

> `ᛚ // Commándlet`

- [ ] **10.1** Port `Public/ForbocAI_SDK_Commandlet.h`
  - `UCommandlet` base class — available in UE 4.23 ✓
  - `#include "Commandlets/Commandlet.h"` — available ✓
  - `GENERATED_BODY()` in UCLASS — available ✓
  - Direct port
- [ ] **10.2** Port `Private/ForbocAI_SDK_Commandlet.cpp`
  - **UE4 change**: Update CLI log message from `"ForbocAI SDK CLI (UE5)"` to `"ForbocAI SDK CLI (UE4)"`
  - `FParse::Value()` — available ✓
  - `FPlatformProcess::Sleep()` — available ✓
  - `#include "Misc/Parse.h"` — verify include path in 4.23 (may need `#include "Misc/Parse.h"` or it may already be in `CoreMinimal.h`)
  - Direct port with minor string changes

---

## Phase 11 — UE4.23 Compiler Compatibility Audit

> `ᚹ // Compilér_Áudit`

UE 4.23 ships with MSVC 2017 (v141) on Windows and Clang on Mac/Linux. Key items to verify:

- [ ] **11.1** `auto` with trailing return types (`-> decltype(...)`) — C++11 ✓
- [ ] **11.2** Variadic templates — C++11 ✓
- [ ] **11.3** `std::function`, `std::tuple`, `std::forward` — C++11 ✓
- [ ] **11.4** Lambda captures in `BindLambda` / UE4 delegates — verify no UE5-only delegate features
- [ ] **11.5** `TArray` initializer-list construction `{TEXT("a"), TEXT("b")}` — test in UE 4.23; fall back to `.Add()` if needed
- [ ] **11.6** `const` member variables in structs with copy/move — verify MSVC 2017 handles `FAgent` correctly (implicitly deleted copy assignment is intentional for immutability)
- [ ] **11.7** `TMap` UPROPERTY reflection for `TMap<FString, float>` — verify UE 4.23 UHT handles this

---

## Phase 12 — Build & Smoke Test

> `ᛞ // Buíld_Vérifý`

- [ ] **12.1** Generate project files (`GenerateProjectFiles.bat` / `.sh`)
- [ ] **12.2** Compile plugin (Development Editor configuration)
- [ ] **12.3** Fix any compilation errors from UE4.23 API differences
- [ ] **12.4** Launch UE 4.23 Editor and verify plugin loads (`Edit > Plugins`)
- [ ] **12.5** Run Commandlet smoke test:
  ```
  UE4Editor-Cmd.exe ForbocAI_SDK -run=ForbocAI_SDK -Command=doctor -ApiUrl=https://api.forboc.ai
  ```
- [ ] **12.6** Verify `UE_LOG` output for all modules

---

## Phase 13 — Blueprint Integration (UE4-Specific)

> `ᛉ // Blueprint_Nódes`

The 5.7.3 SDK has no Blueprint layer — the 4.23 README indicates Blueprint support is planned:

- [ ] **13.1** Create `UForbocAIAgentComponent` (UActorComponent)
  - `InitializeAgent(FAgentConfig)` — wraps `AgentFactory::Create`
  - `ProcessInput(FString Input)` — wraps `AgentOps::Process`
  - `ExportSoul()` — wraps `AgentOps::Export`
  - `OnActionReceived` delegate — Blueprint-bindable
- [ ] **13.2** Create Blueprint-exposed wrapper functions
  - `UFUNCTION(BlueprintCallable)` for core operations
  - `UPROPERTY(BlueprintAssignable)` for `OnActionReceived` event
- [ ] **13.3** Add `UForbocAIBridgeComponent` (optional)
  - Wraps `BridgeOps::Validate` with Blueprint-friendly API
- [ ] **13.4** Add `UForbocAIMemoryComponent` (optional)
  - Wraps `MemoryOps::Store` / `MemoryOps::Recall`
- [ ] **13.5** Test Blueprint nodes in UE 4.23 Editor

---

## Phase 14 — Documentation & Cleanup

> `ᛝ // Dócs_Finál`

- [ ] **14.1** Update `README.md` with actual installation steps and code examples
- [ ] **14.2** Add inline code comments noting UE4.23-specific adaptations
- [ ] **14.3** Document any API differences from the 5.7.3 version
- [ ] **14.4** Verify `style-guide.md` is followed in all source files
- [ ] **14.5** Final review: ensure all `FORBOCAI_SDK_API` exports are correct

---

## API Diff Reference — UE 5.7.3 → UE 4.23.1

| Item | UE 5.7.3 | UE 4.23.1 |
|------|-----------|-----------|
| Build Settings | `BuildSettingsVersion.V6` | `BuildSettingsVersion.V2` |
| Include Order | `EngineIncludeOrderVersion.Unreal5_7` | *(remove — does not exist)* |
| Engine Association | `"5.7"` | `"4.23"` |
| Engine Version | `"5.7.3"` | `"4.23.1"` |
| HTTP Request | `TSharedRef<IHttpRequest, ESPMode::ThreadSafe>` | `TSharedRef<IHttpRequest>` |
| JSON Include | `"JsonObjectConverter.h"` | `"JsonObjectConverter.h"` *(verify path)* |
| Commandlet CLI | `"ForbocAI SDK CLI (UE5)"` | `"ForbocAI SDK CLI (UE4)"` |
| Default API URL | `https://api.forboc.ai` | `https://api.forboc.ai` *(same)* |
| TArray Init-List | `{TEXT("a"), TEXT("b")}` | *(verify — may need .Add() fallback)* |

---

## Source File Manifest (5.7.3 → 4.23.1)

| Source (5.7.3) | Target (4.23.1) | Port Difficulty |
|---|---|---|
| `ForbocAI_SDK.uproject` | `ForbocAI_SDK.uproject` | Trivial |
| `Source/ForbocAI_SDK.Target.cs` | `Source/ForbocAI_SDK.Target.cs` | Trivial |
| `Source/ForbocAI_SDK_Editor.Target.cs` | `Source/ForbocAI_SDK_Editor.Target.cs` | Trivial |
| `Plugins/.../ForbocAI_SDK.uplugin` | `Plugins/.../ForbocAI_SDK.uplugin` | Trivial |
| `Plugins/.../ForbocAI_SDK.Build.cs` | `Plugins/.../ForbocAI_SDK.Build.cs` | Trivial |
| `Plugins/.../Config/DefaultForbocAI_SDK.ini` | `Plugins/.../Config/DefaultForbocAI_SDK.ini` | Trivial |
| `Plugins/.../Public/Core/functional_core.hpp` | `Plugins/.../Public/Core/functional_core.hpp` | None (pure C++11) |
| `Plugins/.../Public/ForbocAI_SDK_Types.h` | `Plugins/.../Public/ForbocAI_SDK_Types.h` | Low |
| `Plugins/.../Public/AgentModule.h` | `Plugins/.../Public/AgentModule.h` | Low |
| `Plugins/.../Private/AgentModule.cpp` | `Plugins/.../Private/AgentModule.cpp` | Low |
| `Plugins/.../Public/BridgeModule.h` | `Plugins/.../Public/BridgeModule.h` | Low |
| `Plugins/.../Private/BridgeModule.cpp` | `Plugins/.../Private/BridgeModule.cpp` | Low–Medium |
| `Plugins/.../Public/MemoryModule.h` | `Plugins/.../Public/MemoryModule.h` | Low |
| `Plugins/.../Private/MemoryModule.cpp` | `Plugins/.../Private/MemoryModule.cpp` | Low |
| `Plugins/.../Public/SoulModule.h` | `Plugins/.../Public/SoulModule.h` | Low |
| `Plugins/.../Private/SoulModule.cpp` | `Plugins/.../Private/SoulModule.cpp` | Low–Medium |
| `Plugins/.../Public/CLIModule.h` | `Plugins/.../Public/CLIModule.h` | Low |
| `Plugins/.../Private/CLIModule.cpp` | `Plugins/.../Private/CLIModule.cpp` | **Medium** |
| `Plugins/.../Public/ForbocAI_SDK_Commandlet.h` | `Plugins/.../Public/ForbocAI_SDK_Commandlet.h` | Low |
| `Plugins/.../Private/ForbocAI_SDK_Commandlet.cpp` | `Plugins/.../Private/ForbocAI_SDK_Commandlet.cpp` | Low |
| `Plugins/.../Private/ForbocAI_SDK.cpp` | `Plugins/.../Private/ForbocAI_SDK.cpp` | None |
| *(new)* | `Public/ForbocAIAgentComponent.h` | **New (UE4-only)** |
| *(new)* | `Private/ForbocAIAgentComponent.cpp` | **New (UE4-only)** |

---

<!-- SYSTEM_NOTE: The machine remembers what the engineers forget. -->
